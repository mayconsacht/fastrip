<div class='general-form-trips'>

  <% if flash[:notice] %>
    <div class="notice"><%= flash[:notice] %></div>
  <% end %>
  
  <h1>Minhas Viagens</h1>
  
  <div class='panel panel-default'>

    <table class="table table-striped table-hover">
      <tbody>
        <% @requests.each do |request| %>
          <tr>
            <td><%= image_tag request.trip.avatar.url(:thumb), :class => 'thumbnail' %></td>
            <td><%= request.trip.name %></td>
            <td><%= request.trip.category %></td>
            <td><%= request.trip.origin %></td>
            <td><%= request.trip.destination %></td>
            <td><%= request.trip.price %></td>
            <td><%= request.trip.in_date %></td>
            <td><%= request.trip.out_date %></td>
            <td><%= request.status %></td>
            <td><div class="btn-group" role="group" aria-label="...">
              <% if request.trip.out_date.past? %>
                <%= link_to 'Avaliar', '#new_post_modal', :locals => {:name => request.trip.name}, 'type' => 'button', 'data-toggle' => 'modal', :class => 'btn btn-default btn-xs'%>
              <% end %>
              <%= link_to 'Detalhar', request.trip, :class => 'btn btn-default btn-xs'%>
              <%= link_to 'Cancelar', request.trip, method: :delete, :class => 'btn btn-default btn-xs', data: { confirm: 'Tem certeza que deseja deletar a viagem?' } %>
            </div></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="modal fade" id="new_post_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">Avalie sua experiencia com está agência de viagem!</h4>
        </div>
        <div class="modal-body">
          <%# Render the new person form (passing modal => true to enable remote => true) %>
          <%= render 'posts/form', modal: true %>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>